@inherits Glass.Mapper.Sc.Web.Mvc.GlassView<Vitality.Website.Areas.Presales.ComponentTemplates.FeatureBlocks.VacancyList>

<div class="pinch">
    @if (Sitecore.Context.PageMode.IsExperienceEditor)
    {
        <h3>[Vacancy Title]</h3>
        <ul>
            <li>@Editable(Model, m => m.LocationText) [Vacancy Location]</li>
            <li>@Editable(Model, m => m.SalaryText) [Vacancy Salary]</li>
            <li>@Editable(Model, m => m.ClosesOnText) [Vacancy Closes On]</li>
        </ul>

        <div><a class="box-button box-button--rounded box-button box-button--primary">@Editable(Model, m => m.ApplyForVacancyText)</a></div>
        <div><a class="box-button box-button--rounded box-button--primary-inverse">@Editable(Model, m => m.BackToVacanciesListText)</a></div>

        <hr />

        <div>[Vacancy Description]</div>        
    }
    else
    {
        <vacancy-details>Retrieving job details...</vacancy-details>

        <script src="https://unpkg.com/core-js/client/shim.min.js"></script>
        <!-- Update these package versions as needed -->
        <script src="https://unpkg.com/zone.js@0.8.4?main=browser"></script>
        <script src="https://unpkg.com/systemjs@0.19.39/dist/system.src.js"></script>
        <script src="/js/systemjs.config.server.js"></script>

        <script type='text/javascript'>
            // TODO: reference npm packages locally from dev env

            //if ('presales.vitality.co.uk' === document.location.host) {
            //    document.write("<script src='node_modules/core-js/client/shim.min.js'><\/script>");
            //    document.write("<script src='node_modules/zone.js/dist/zone.js'><\/script>");
            //    document.write("<script src='node_modules/systemjs/dist/system.src.js'><\/script>");

            //    //<![CDATA[
            //    document.write("<script src='/js/systemjs.config.js'><\/script>");
            //    //]]>
            //} else {
            //    // This SystemJS configuration loads umd packages from the web
            //    // Update these package versions as needed
            //    document.write("<script src='https://unpkg.com/core-js/client/shim.min.js'><\/script>");
            //    document.write("<script src='https://unpkg.com/zone.js@0.8.4?main=browser'><\/script>");
            //    document.write("<script src='https://unpkg.com/systemjs@0.19.39/dist/system.src.js'><\/script>");

            //    //<![CDATA[
            //    document.write("<script src='/js/systemjs.server.config.js'><\/script>");
            //    //]]>
            //}

            System.import('/js/vacancyDetails-Main.js')
                .catch(function (err) { console.error(err); });

            window.angularData = window.angularData || {};
            window.angularData.headline = '@Model.Headline';
            window.angularData.locationsDropdownLabel = '@Model.LocationsDropdownLabel';
            window.angularData.allLocationsText = '@Model.AllLocationsText';
            window.angularData.departmentsDropdownLabel = '@Model.DepartmentsDropdownLabel';
            window.angularData.allDepartmentsText = '@Model.AllDepartmentsText';
            window.angularData.findoutMoreText = '@Model.FindoutMoreText';
            window.angularData.noVacanciesFoundText = '@Model.NoVacanciesFoundText';
            window.angularData.FeedSettings = '@Model.FeedSettings';
            window.angularData.locationText = '@Model.LocationText';
            window.angularData.salaryText = '@Model.SalaryText';
            window.angularData.closesOnText = '@Model.ClosesOnText';
            window.angularData.applyForVacancyText = '@Model.ApplyForVacancyText';
            window.angularData.shareVacancyText = '@Model.ShareVacancyText';
            window.angularData.backToVacanciesListingText = '@Model.BackToVacanciesListText';

        </script>
    }    
</div>


