angular.module("FeemaximaService",[]).service("FeemaximaService",["$q","$http",function(e,t){"use strict";this.datasetTypes={Chapter:"Chapter",Section:"Section",Procedure:"Procedure"},this.datasets={chapters:[],sections:[],procedures:[]},this.subArrayPropertyNames={Procedures:"Procedures",Sections:"Sections"},this.getChapters=function(){var r=e.defer();return t.get("/api/feemaxima/list/?settingsId="+window.angularData.CcsdFeedSettingsId).success(function(e){r.resolve(e)}).error(function(){r.reject()}),r.promise},this.populateDatasets=function(e){var t=this.datasetTypes;this.datasets.chapters=_.uniq(_.map(e,function(e){return{Id:e.Id,Value:_.unescape(e.Name),Type:t.Chapter}}));var r=_.flatten(_.pluck(e,this.subArrayPropertyNames.Sections));this.datasets.sections=_.uniq(_.map(r,function(e){return{Id:e.Id,Value:_.unescape(e.Name),Type:t.Section}})),this.datasets.procedures=_.uniq(_.map(_.flatten(_.pluck(r,this.subArrayPropertyNames.Procedures)),function(e){return{Code:e.Code,Value:_.unescape(e.Description),Type:t.Procedure}}),!1,function(e){return e.Code})},this.searchDatasets=function(e,t,r){return r=(r||"").toLowerCase(),_.sortBy(this.datasets[e].filter(function(e){return e[t].toLowerCase().indexOf(r)>-1}),t)}}]),angular.module("LiteratureFormService",[]).service("LiteratureFormService",["$http",function(e){"use strict";var t=[],r=[],n={PlanNumber:"PlanNumber",PlanType:"PlanType",Title:"Title"};this.formState={date:moment(),planCode:"",planType:""},this.getDocuments=function(){return _.sortBy(r.filter(function(e){return+e.PlanNumber==+this.formState.planCode&&moment(e.EffectivePlanDate).isAfter(this.formState.date)&&e.PlanType===this.formState.planType},this).map(function(e){return e.FileType=_.last(e.Document.split(".")).toUpperCase(),e}),n.Title)},this.getPlanCodes=function(){return _.uniq(_.pluck(r,n.PlanNumber)).sort()},this.getPlanTypes=function(i){t&&t.length>0&&i(t),e.get("/api/literature/"+window.angularData.literaturePath.toLowerCase()+"/").error(function(){}).then(function(e){r=_.filter(e.data,function(e){return e.PlanNumber&&e.PlanType}),t=_.uniq(_.pluck(r,n.PlanType)).sort(),i(t)})}}]),angular.module("LiteratureLibraryService",[]).service("LiteratureLibraryService",["$http","$window",function(e){"use strict";var t=[],r=[],n={},i={Category:"Category",Title:"Title"};this.currentDocument=function(){return n},this.getDocument=function(e){for(var t=0;t<r.length;++t){var n=r[t];if(n.Key===e)return n}},this.getCategories=function(n){t&&t.length>0&&n(t),e.get("/api/literature/"+window.angularData.literaturePath.toLowerCase()+"/").error(function(){}).then(function(e){r=e.data,r.forEach(function(e){e.EffectivePlanDate&&(e.EffectivePlanDate=new Date(e.EffectivePlanDate))}),t=Object.keys(r.reduce(function(e,t){return e[t.Category]=!0,e},{})).sort().map(function(e){return{Name:e,IsSelected:!1}}),n(t)})},this.getDocuments=function(e){return _.sortBy(r.filter(function(t){return t.Category===e}),i.Title)},this.filterByDate=function(e){return _.sortBy(r.filter(function(t){var r=t.EffectivePlanDate;return r&&r>=e}),i.Title)},this.searchDocuments=function(e){return e=(e||"").toLowerCase(),_.sortBy(r.filter(function(t){return t.Title.toLowerCase().indexOf(e)>-1}),i.Title)}}]),angular.module("SiteSearchService",[]).service("SiteSearchService",["$http","$q","$sce",function(e,t,r){"use strict";function n(e,t){return r.trustAsHtml(e.replace(new RegExp(t,"gi"),function(e){return'<span class="text--primary">'+e+"</span>"}))}var i={orderBy:"asc",pageNo:1,pageSize:50};this.search=function(r){var a=t.defer();return i.searchQuery=(r||"").toLowerCase(),e.post("/api/search/",i).error(function(e){a.resolve([])}).success(function(e){var t=_.map(_.filter(e,function(e){return!!e.Title}),function(e){return{breadcrumb:e.Breadcrumbs,description:n(e.Description,r),title:n(e.Title,r),url:e.Path}});a.resolve(t)}),a.promise}}]),window.SocialConnectorApp=angular.module("SocialConnectorApp",[]).directive("popularityCount",["$http",function(e){"use strict";return{restrict:"E",scope:{settingsId:"=settingsId",countInfo:"=countDisplayText"},controller:function(t){e.get("/api/socialmedia/popularitycounts?settingsid="+t.settingsId).then(function(e){t.countInfo=e.data.Count})},template:"{{countInfo}}"}}]);